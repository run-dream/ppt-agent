# 需求文档 - ChatPPT

## 介绍

ChatPPT 是一个基于 AI Agent 工作流的系统，旨在将用户的非结构化输入（文本、语音、文档）自动转化为结构化的、专业精美的 PPT 演示文稿。

## 需求

### 需求 1 - 多模态输入解析

**用户故事：** 作为一名办公人员，我希望能够通过语音或上传 Word 文档的方式提供素材，以便系统能自动提取核心内容。

#### 验收标准

1. When 用户上传音频文件时，ChatPPT 应当调用 Whisper ASR 将音频转换为文本。
2. When 用户上传 .docx 文档时，ChatPPT 应当解析文档结构并提取关键段落。
3. The ChatPPT 应当支持 Markdown 格式的纯文本输入。

### 需求 2 - 智能大纲与内容生成

**用户故事：** 作为一名演示者，我希望系统能根据我的模糊需求生成逻辑严谨的 PPT 大纲，并允许我进行人工调整，以确保内容符合我的预期。

#### 验收标准

1. When 接收到输入内容后，ChatPPT 应当生成一个包含章节标题和要点的结构化大纲。
2. While 在大纲生成后，ChatPPT 应当暂停并允许用户预览及修改。
3. When 用户确认大纲后，ChatPPT 应当根据大纲内容扩写每张幻灯片的详细文案。

### 需求 3 - 自动配图建议

**用户故事：** 作为一名 PPT 制作人，我希望系统能根据文字内容自动搜索或生成合适的图片，以增强视觉效果。

#### 验收标准

1. When 内容生成完成后，ChatPPT 应当根据幻灯片语义生成图片搜索关键词。
2. The ChatPPT 应当能够从 Bing 或其他图片库中检索相关图片。
3. Where 无法找到合适图片时，ChatPPT 应当建议使用 DALL-E 生成对应的视觉素材。

### 需求 4 - PPT 渲染与导出

**用户故事：** 作为一名最终用户，我希望最终能下载到一个标准的 .pptx 文件，该文件可以在 PowerPoint 中直接编辑。

#### 验收标准

1. The ChatPPT 应当使用 `python-pptx` 引擎将结构化数据渲染为 .pptx 文件。
2. When 渲染过程中，ChatPPT 应当自动匹配合适的版式（Layout）。
3. The 系统应当提供生成好的文件下载链接。
